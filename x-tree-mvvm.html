<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>xtree.js</title>
    <link rel="stylesheet" href="src/lib/fonts/iconfont.css">
    <link rel="stylesheet" href="src/css/xtree.css">
</head>
<body>
<script type="text/javascript" src="src/lib/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="src/js/x-tree-closure.js"></script>


<div class="tree-wrap">
    <div id="x-tree-odp-1" class="tree-node-wrap">
        <i class="iconfont icon-expand"></i>
    </div>
    <div class="tree-node-wrap">
        <i id="x-tree-odp-input" class="iconfont icon-expand"></i>
        <i id="x-tree-odp-checkbox" class="iconfont icon-checked"></i>
        <div class="tree-node-wrap">
            <i id="x-tree-odp-input-2" class="iconfont icon-expand"></i>
            <i id="x-tree-odp-checkbox-2" class="iconfont icon-checked"></i>
        </div>
    </div>
    <div class="tree-node-wrap">
        <i id="x-tree-odp-output" class="iconfont icon-expand"></i>
    </div>
</div>

<script>
//    document.getElementById("MyElement").className =
//        document.getElementById("MyElement").className.replace
//        ( /(?:^|\s)MyClass(?!\S)/g , '' )
//    document.getElementById("MyElement").className += " MyClass"

////H5
//document.getElementById("MyElement").classList.add('class');
//
//document.getElementById("MyElement").classList.remove('class');
//
//if ( document.getElementById("MyElement").classList.contains('class') )
//
//    document.getElementById("MyElement").classList.toggle('class');

    var dataBase = [
        {id: 1, name: '行政部', nodeId: 0, is_node: true, is_check: false},
        {id: 3, name: '财务部3', nodeId: 1, is_node: true, is_check: false},
        {id: 11, name: '财务部4', nodeId: 3, is_node: true, is_check: false},
        {id: 12, name: '财务部5', nodeId: 11, is_node: true, is_check: false},
        {id: 13, name: '财务部6', nodeId: 12, is_node: true, is_check: false},
        {id: 14, name: '财务部7', nodeId: 13, is_node: true, is_check: false},
        {id: 15, name: '财务部8', nodeId: 14, is_node: true, is_check: false},
        {id: 16, name: '财务部9', nodeId: 15, is_node: true, is_check: false},
        {id: 8, name: '财务部2', nodeId: 3, is_node: true, is_check: false},
        {id: 5, name: '李职员', nodeId: 8, is_node: false, is_check: false},
        {id: 6, name: '孙职员', nodeId: 8, is_node: false, is_check: false},
        {id: 2, name: '张部长', nodeId: 1, is_node: false, is_check: false},
        {id: 4, name: '刘职员', nodeId: 3, is_node: false, is_check: false},
        {id: 9, name: '王经理', nodeId: 0, is_node: false, is_check: false}
    ];
    var domBase = $('#x-tree-odp-1');
    var domTemp = {};
    var dataOdp = {};
    var dataDes = {
        get:function () {
            console.log('getdb',dataBase);
            return iconBase;
        },
        set:function (value) {
            iconBase = value;
            if(iconBase){
                toggleClass(domTemp);
            }else{
                toggleClass(domTemp);
            }
            console.log('setdb',dataOdp);
        }
    };
    Object.defineProperty(dataOdp, 'data', dataDes);
    domBase.on('click', function(e){
        console.log('e.srcElement',e.target);
        domTemp = e.target;
        dataOdp.data = dataBase;
    });





    var domOutput = $('#x-tree-odp-output');
    var iconBase = true;
    var dataDescriptor ={
        get:function () {
            console.log('getdb',dataOdp);
            return iconBase;
        },
        set:function (value) {
            iconBase = value;
            if(iconBase){
                toggleClass(domBase);
                toggleClass(domOutput);
            }else{
                toggleClass(domBase);
                toggleClass(domOutput);
            }
            console.log('setdb',dataOdp);
        }
    };

    Object.defineProperty(dataOdp, 'icon', dataDescriptor);
    var icon = document.getElementById('x-tree-odp-input');
    icon.addEventListener('click', function (e) {
        console.log('iconBase-1',iconBase);
        console.log('dataOdp.is_expand-1',dataOdp.icon);
        dataOdp.icon = !iconBase;
        console.log('iconBase-2',iconBase);
        console.log('dataOdp.is_expand-2',dataOdp.icon);
    });

//    for (var i = 0; i < data.length; i++) {
//        dataOdp[i] = data[i];
////        dataOdp[i].id = data[i].id;
////        dataOdp[i].name = data[i].name;
////        dataOdp[i].nodeId = data[i].nodeId;
////        dataOdp[i].is_node = data[i].is_node;
////        dataOdp[i].is_check = data[i].is_check;
//    }
    function makeExpand() {
        var html = '<i class="iconfont icon-expand"></i>';
        return $(html).css({
            'font-size': '14px',
            'font-weight': 'bold',
            'vertical-align': 'base-line',
            'padding-right': '0px',
            'cursor': 'pointer'
        })[0].outerHTML;
    }

    function toggleClass(dom) {
        console.log('toExpand',dom);
        dom.classList.toggle('icon-shrink');
        dom.classList.toggle('icon-expand');
    }

</script>











git

<div id="odp-wrap" class="tree-wrap">
    <input id="odp-input-id" class="odp-input" type="text" placeholder="" value="odp-mvvm-id">
    <div id="odp-output-id" class="odp-output">odp-mvvm</div>

    <input id="odp-input-name" class="odp-input" type="text" placeholder="" value="odp-mvvm-name">
    <div id="odp-output-name" class="odp-output">odp-mvvm</div>

    <input id="odp-input-nodeId" class="odp-input" type="text" placeholder="" value="odp-mvvm-nodeId">
    <div id="odp-output-nodeId" class="odp-output">odp-mvvm</div>
</div>
<script>
//    Object.defineProperty(obj, prop, descriptor)
var xTestData = {};
var idBase = '';
var idDescriptor = {
    get:function () {
        console.log(idBase);
    },
    set:function (value) {
        idBase = value;
        document.getElementById('odp-input-id').value = idBase;
        document.getElementById('odp-output-id').innerHTML = idBase;
        console.log(idBase);
    }
};
Object.defineProperty(xTestData, 'id', idDescriptor);
var idInput = document.getElementById('odp-input-id');
idInput.addEventListener('input', function (e) {
    xTestData.id = e.srcElement.value;
});


var nameBase = '';
var nameDescriptor = {
    get:function () {
        console.log(nameBase);
    },
    set:function (value) {
        nameBase = value;
        document.getElementById('odp-input-name').value = nameBase;
        document.getElementById('odp-output-name').innerHTML = nameBase;
        console.log(nameBase);
    }
};
Object.defineProperty(xTestData, 'name', nameDescriptor);
var nameInput = document.getElementById('odp-input-name');
nameInput.addEventListener('input', function (e) {
    xTestData.name = e.srcElement.value;
});

var nodeIdBase = '';
var nodeIdTemp = '';
var nodeIdDescriptor = {
    get:function () {
        console.log(nodeIdBase);
    },
    set:function (value) {
        nodeIdTemp = value;
        nodeIdBase = value;
        document.getElementById('odp-input-nodeId').value = nodeIdBase;
        document.getElementById('odp-output-nodeId').innerHTML = nodeIdBase;
        console.log(nodeIdBase);
    }
};
Object.defineProperty(xTestData, 'nodeId', nodeIdDescriptor);
var nodeIdInput = document.getElementById('odp-input-nodeId');
nodeIdInput.addEventListener('click', function (e) {
    nodeIdTemp += 1;
    xTestData.nodeId = nodeIdTemp;
});


</script>













<div class="tree-wrap">
    <!--    <input class="test_tree1" placeholder="">-->
    <div class="test_tree1"></div>
</div>
<script>
    var testTree1 = xTreeClosure({
        dom: $('.test_tree1'),
        only_leaf: false,
        node_merge: false,
        is_multi: true,
        is_trigger: false,
        has_search: false,
        expand: 6,
        data: [
            {id: 1, name: '行政部', nodeId: 0, is_node: true, is_check: false},
            {id: 3, name: '财务部3', nodeId: 1, is_node: true, is_check: false},
            {id: 11, name: '财务部4', nodeId: 3, is_node: true, is_check: false},
            {id: 12, name: '财务部5', nodeId: 11, is_node: true, is_check: false},
            {id: 13, name: '财务部6', nodeId: 12, is_node: true, is_check: false},
            {id: 14, name: '财务部7', nodeId: 13, is_node: true, is_check: false},
            {id: 15, name: '财务部8', nodeId: 14, is_node: true, is_check: false},
            {id: 16, name: '财务部9', nodeId: 15, is_node: true, is_check: false},
            {id: 8, name: '财务部2', nodeId: 3, is_node: true, is_check: false},
            {id: 5, name: '李职员', nodeId: 8, is_node: false, is_check: false},
            {id: 6, name: '孙职员', nodeId: 8, is_node: false, is_check: false},
            {id: 2, name: '张部长', nodeId: 1, is_node: false, is_check: false},
            {id: 4, name: '刘职员', nodeId: 3, is_node: false, is_check: false},
            {id: 1, name: '王经理', nodeId: 0, is_node: false, is_check: false}
        ],
        onInit: function () {
            console.log('init');
        },
        onOpen: function () {
            console.log('open');
        },
        onBeforeOpen: function () {
            console.log('beforeopen');
        },
        onClose: function (hasChange) {
            console.log('close');
            console.log(testTree1.getId());
        },
        onCheck: function (item, dom, childrenItem) {
            console.log('check: ', this );
            console.log(testTree1.getName());
            console.log(testTree1.getId());
            console.log(testTree1.getItem());
        },
        onCancel: function (item, dom, childrenItem) {
            console.log('cancel: ', this );
        }
    });
</script>


</body>
</html>